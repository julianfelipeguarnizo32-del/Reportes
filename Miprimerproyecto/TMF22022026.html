<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Performance (KPIs) TDM ‚Äî 19.02.2026</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=Work+Sans:wght@300;400;500;600;700&display=swap');

  :root {
    --bg: #f8fafc;
    --surface: #ffffff;
    --card: #ffffff;
    --border: #e2e8f0;
    --accent: #0891b2;
    --accent2: #06b6d4;
    --green: #059669;
    --red: #dc2626;
    --yellow: #d97706;
    --text: #1e293b;
    --muted: #64748b;
    --header-font: 'Crimson Pro', serif;
    --body-font: 'Work Sans', sans-serif;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { 
    background: var(--bg); 
    color: var(--text); 
    font-family: var(--body-font); 
    font-size: 13px; 
    min-height: 100vh; 
  }

  /* HEADER */
  header {
    background: linear-gradient(135deg, #0891b2 0%, #0e7490 50%, #155e75 100%);
    border-bottom: 1px solid rgba(255,255,255,0.1);
    padding: 28px 32px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
  }
  header h1 { 
    font-family: var(--header-font); 
    font-size: 32px; 
    font-weight: 700; 
    color: #ffffff; 
    letter-spacing: -0.5px;
  }
  .header-badge { 
    display: inline-block; 
    background: rgba(255,255,255,0.2); 
    border: 1px solid rgba(255,255,255,0.3); 
    padding: 4px 12px; 
    border-radius: 20px; 
    font-size: 11px; 
    font-weight: 600; 
    margin-left: 12px;
    color: #ffffff;
  }
  header .meta { 
    color: rgba(255,255,255,0.9); 
    font-size: 13px; 
    text-align: right; 
    line-height: 1.8; 
  }
  header .meta span { color: #ffffff; font-weight: 600; }

  /* NAV */
  nav {
    background: var(--surface);
    border-bottom: 2px solid var(--border);
    padding: 0 32px;
    display: flex;
    box-shadow: 0 1px 3px rgba(0,0,0,0.02);
  }
  nav button {
    background: none; 
    border: none; 
    color: var(--muted);
    font-family: var(--body-font); 
    font-size: 13px; 
    font-weight: 600;
    padding: 16px 20px;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    transition: all 0.2s;
    letter-spacing: 0.2px;
  }
  nav button:hover { color: var(--accent); }
  nav button.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
  }

  /* MAIN */
  main { padding: 32px; max-width: 1600px; margin: 0 auto; }

  .tab-panel { display: none; }
  .tab-panel.active { display: block; animation: fadeIn 0.3s ease; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

  /* KPI CARDS */
  .kpi-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 16px;
    margin-bottom: 32px;
  }
  .kpi {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px 22px;
    position: relative;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    transition: transform 0.2s, box-shadow 0.2s;
  }
  .kpi:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  }
  .kpi::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
  }
  .kpi.indigo::before { background: linear-gradient(90deg, #6366f1, #8b5cf6); }
  .kpi.green::before { background: linear-gradient(90deg, #059669, #10b981); }
  .kpi.yellow::before { background: linear-gradient(90deg, #d97706, #f59e0b); }
  .kpi.cyan::before { background: linear-gradient(90deg, #0891b2, #06b6d4); }
  .kpi.teal::before { background: linear-gradient(90deg, #0d9488, #14b8a6); }
  .kpi.red::before { background: linear-gradient(90deg, #dc2626, #ef4444); }

  .kpi-label { 
    color: var(--muted); 
    font-size: 11px; 
    font-weight: 600; 
    letter-spacing: 0.5px; 
    text-transform: uppercase; 
    margin-bottom: 10px; 
  }
  .kpi-value { font-size: 24px; font-weight: 700; line-height: 1; margin-bottom: 6px; color: var(--text); }
  .kpi-sub { color: var(--muted); font-size: 11.5px; }
  .kpi-badge { 
    display: inline-block; 
    font-size: 10px; 
    font-weight: 600; 
    padding: 3px 8px; 
    border-radius: 5px; 
    margin-top: 6px; 
  }
  .badge-up { background: rgba(5,150,105,0.12); color: var(--green); }
  .badge-down { background: rgba(220,38,38,0.12); color: var(--red); }

  /* SECTION TITLES */
  .section-title {
    font-family: var(--header-font);
    font-size: 20px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 18px;
    padding-bottom: 10px;
    border-bottom: 2px solid var(--border);
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .section-title .icon { font-size: 22px; }

  /* ALERTS */
  .alerts { display: flex; flex-direction: column; gap: 12px; margin-bottom: 32px; }
  .alert {
    background: var(--card);
    border: 1px solid var(--border);
    border-left: 4px solid;
    border-radius: 10px;
    padding: 16px 20px;
    display: flex;
    align-items: flex-start;
    gap: 14px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }
  .alert-red { border-left-color: var(--red); background: rgba(220,38,38,0.02); }
  .alert-yellow { border-left-color: var(--yellow); background: rgba(217,119,6,0.02); }
  .alert-green { border-left-color: var(--green); background: rgba(5,150,105,0.02); }
  .alert-icon { font-size: 18px; flex-shrink: 0; margin-top: 2px; }
  .alert-title { font-weight: 600; font-size: 13.5px; margin-bottom: 4px; color: var(--text); }
  .alert-body { color: var(--muted); font-size: 12.5px; line-height: 1.6; }
  .alert-stores { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 8px; }
  .store-tag { 
    background: rgba(8,145,178,0.08); 
    border: 1px solid rgba(8,145,178,0.2); 
    border-radius: 5px; 
    padding: 2px 8px; 
    font-size: 11px; 
    font-weight: 600;
    color: var(--accent);
  }

  /* TABLES */
  .table-wrap {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }
  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12.5px;
  }
  thead th {
    background: #f1f5f9;
    color: var(--muted);
    font-weight: 600;
    text-transform: uppercase;
    font-size: 11px;
    letter-spacing: 0.5px;
    padding: 12px 16px;
    text-align: right;
    border-bottom: 2px solid var(--border);
    cursor: pointer;
    white-space: nowrap;
    user-select: none;
    position: relative;
  }
  thead th:first-child { 
    text-align: left;
    position: sticky;
    left: 0;
    background: #f1f5f9;
    z-index: 2;
  }
  thead th:hover { color: var(--accent); }
  tbody tr { transition: background 0.15s; }
  tbody tr:hover { background: rgba(8,145,178,0.04); }
  tbody td {
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    text-align: right;
  }
  tbody td:first-child { 
    text-align: left; 
    font-weight: 600;
    position: sticky;
    left: 0;
    background: var(--card);
    z-index: 1;
  }
  tbody tr:hover td:first-child { background: rgba(8,145,178,0.04); }
  tbody tr:last-child td { border-bottom: none; }

  .chip {
    display: inline-block;
    padding: 3px 9px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
  }
  .chip-green { background: rgba(5,150,105,0.12); color: var(--green); }
  .chip-red { background: rgba(220,38,38,0.12); color: var(--red); }
  .chip-yellow { background: rgba(217,119,6,0.12); color: var(--yellow); }

  /* CHARTS */
  .two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
  .chart-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }
  .chart-title {
    font-size: 12px;
    font-weight: 600;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 18px;
  }

  /* HORIZONTAL BARS */
  .hbar { display: flex; flex-direction: column; gap: 8px; }
  .hbar-row { display: flex; align-items: center; gap: 12px; }
  .hbar-label { width: 40px; font-size: 11.5px; font-weight: 600; color: var(--muted); text-align: right; flex-shrink: 0; }
  .hbar-track { 
    flex: 1; 
    height: 20px; 
    background: #f1f5f9; 
    border-radius: 4px; 
    overflow: hidden; 
    position: relative; 
  }
  .hbar-fill { 
    height: 100%; 
    border-radius: 4px; 
    display: flex; 
    align-items: center; 
    padding-left: 8px; 
    font-size: 10.5px; 
    font-weight: 600; 
    transition: width 0.6s ease;
    color: #ffffff;
  }
  .hbar-val { width: 54px; font-size: 11.5px; text-align: right; flex-shrink: 0; font-variant-numeric: tabular-nums; font-weight: 600; }

  /* FILTERS */
  .filter-bar {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
    align-items: center;
    flex-wrap: wrap;
  }
  .filter-bar input, .filter-bar select {
    background: var(--card);
    border: 1px solid var(--border);
    color: var(--text);
    font-family: var(--body-font);
    font-size: 12.5px;
    padding: 9px 14px;
    border-radius: 8px;
    outline: none;
  }
  .filter-bar input:focus, .filter-bar select:focus { border-color: var(--accent); }
  .filter-btn {
    background: var(--accent);
    color: #fff;
    border: none;
    font-family: var(--body-font);
    font-size: 12.5px;
    font-weight: 600;
    padding: 9px 16px;
    border-radius: 8px;
    cursor: pointer;
    transition: opacity 0.2s;
  }
  .filter-btn:hover { opacity: 0.9; }
  .filter-btn.secondary { 
    background: #f1f5f9; 
    border: 1px solid var(--border); 
    color: var(--muted); 
  }

  /* BAR VIS */
  .bar-wrap { display: flex; align-items: center; gap: 10px; justify-content: flex-end; }
  .bar-track { width: 80px; height: 6px; background: #f1f5f9; border-radius: 3px; overflow: hidden; }
  .bar-fill { height: 100%; border-radius: 3px; }

  .rank-num { color: var(--muted); font-size: 11.5px; font-weight: 700; }
  .rank-1 { color: #d97706; }
  .rank-2 { color: #94a3b8; }
  .rank-3 { color: #b87333; }

  .mt-20 { margin-top: 20px; }

  /* RESPONSIVE */
  @media (max-width: 768px) {
    body { font-size: 12px; }
    
    header {
      flex-direction: column;
      align-items: flex-start;
      gap: 12px;
      padding: 20px;
    }
    header h1 { font-size: 24px; }
    header .meta { text-align: left; font-size: 12px; }

    nav { 
      padding: 0 16px; 
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    nav::-webkit-scrollbar { display: none; }
    nav button { 
      padding: 14px 16px; 
      font-size: 12px; 
      white-space: nowrap;
      flex-shrink: 0;
      min-height: 44px;
    }

    main { padding: 20px 16px; }

    .kpi-grid {
      grid-template-columns: 1fr 1fr !important;
      gap: 12px;
    }
    .kpi { padding: 16px 18px; }
    .kpi-label { font-size: 10px; }
    .kpi-value { font-size: 20px; }
    .kpi-sub { font-size: 10.5px; }

    .section-title { font-size: 18px; margin-bottom: 14px; }

    .two-col { 
      grid-template-columns: 1fr !important; 
      gap: 18px; 
    }

    .alerts { gap: 10px; }
    .alert { 
      padding: 12px 16px; 
      flex-direction: column;
      gap: 10px;
    }
    .alert-icon { font-size: 16px; }
    .alert-title { font-size: 12.5px; }
    .alert-body { font-size: 11.5px; }
    .store-tag { font-size: 10px; padding: 2px 7px; }

    .chart-card { padding: 18px; }
    .chart-title { font-size: 10.5px; margin-bottom: 14px; }

    .hbar-label { width: 34px; font-size: 10.5px; }
    .hbar-track { height: 16px; }
    .hbar-fill { font-size: 9.5px; padding-left: 6px; }
    .hbar-val { width: 50px; font-size: 10.5px; }

    .table-wrap { 
      position: relative;
    }
    .table-wrap::after {
      content: '‚Üê Desliza ‚Üí';
      position: absolute;
      bottom: 10px;
      right: 10px;
      background: rgba(8,145,178,0.15);
      color: var(--accent);
      font-size: 9.5px;
      font-weight: 600;
      padding: 4px 10px;
      border-radius: 5px;
      pointer-events: none;
      opacity: 0.8;
      letter-spacing: 0.3px;
      border: 1px solid rgba(8,145,178,0.2);
    }
    table { 
      font-size: 11px;
      min-width: 600px;
    }
    thead th { 
      padding: 10px 12px; 
      font-size: 10px;
    }
    thead th:first-child {
      position: sticky;
      left: 0;
      background: #f1f5f9;
      z-index: 3;
    }
    tbody td { padding: 10px 12px; }
    tbody td:first-child {
      position: sticky;
      left: 0;
      background: var(--card);
      z-index: 2;
      max-width: 60px;
      overflow: hidden;
      text-overflow: ellipsis;
      box-shadow: 2px 0 4px rgba(0,0,0,0.05);
    }

    .chip { font-size: 10px; padding: 2px 7px; }

    .filter-bar { 
      flex-direction: column; 
      align-items: stretch; 
      gap: 10px; 
    }
    .filter-bar input, 
    .filter-bar select,
    .filter-btn { 
      width: 100%; 
      font-size: 12px;
      padding: 12px 14px;
      min-height: 44px;
    }

    .bar-track { width: 60px; }
  }

  @media (max-width: 480px) {
    header h1 { font-size: 20px; }
    .kpi-grid { grid-template-columns: 1fr !important; }
    .kpi-value { font-size: 22px; }
    table { min-width: 500px; }
    nav button { font-size: 11px; padding: 12px 14px; }
  }

  /* Landscape mobile */
  @media (max-width: 900px) and (orientation: landscape) {
    header { padding: 16px 20px; }
    header h1 { font-size: 22px; }
    nav button { padding: 12px 16px; }
    .kpi-grid { 
      grid-template-columns: repeat(3, 1fr) !important;
      gap: 12px;
    }
  }
</style>
</head>
<body>

<header>
  <div>
    <h1>üìä Performance (KPIs) TDM<span class="header-badge">Indicadores TDM</span></h1>
    <div style="color:rgba(255,255,255,0.85);font-size:13px;margin-top:6px;">Indicadores Shopping Tex ¬∑ Corte <span>19 de febrero, 2026</span></div>
  </div>
  <div class="meta">
    <div>28 tiendas activas ¬∑ 6 inactivas</div>
    <div>Datos al <span>19/02/2026</span></div>
    <div style="margin-top:6px;">
      <span>‚óè</span> Sobre meta: 9 &nbsp;
      <span>‚óè</span> Bajo meta: 19
    </div>
  </div>
</header>

<nav>
  <button class="active" onclick="switchTab('resumen')">üìã Resumen Ejecutivo</button>
  <button onclick="switchTab('cumplimiento')">üéØ Cumplimiento</button>
  <button onclick="switchTab('rentabilidad')">üí∞ Rentabilidad</button>
  <button onclick="switchTab('clientes')">üë• Clientes</button>
  <button onclick="switchTab('inventario')">üì¶ Inventario & M¬≤</button>
  <button onclick="switchTab('ranking')">üèÜ Ranking General</button>
</nav>

<main>

<!-- TAB: RESUMEN -->
<div id="tab-resumen" class="tab-panel active">

  <div class="kpi-grid">
    <div class="kpi indigo">
      <div class="kpi-label">Ventas Ejecutadas</div>
      <div class="kpi-value" style="font-size:19px">$3,261M</div>
      <div class="kpi-sub">Corte 19 Feb 2026</div>
    </div>
    <div class="kpi green">
      <div class="kpi-label">Utilidad Total</div>
      <div class="kpi-value" style="font-size:19px">$1,667M</div>
      <div class="kpi-badge badge-up">Acum 2026</div>
    </div>
    <div class="kpi yellow">
      <div class="kpi-label">Cumplimiento Total</div>
      <div class="kpi-value">99.2%</div>
      <div class="kpi-sub">vs. ppto corte</div>
    </div>
    <div class="kpi cyan">
      <div class="kpi-label">Rentabilidad Total</div>
      <div class="kpi-value">51.1%</div>
      <div class="kpi-badge badge-up">‚ñ≤ vs 40.9% (2025)</div>
    </div>
    <div class="kpi teal">
      <div class="kpi-label">Efectividad Prom</div>
      <div class="kpi-value">53.7%</div>
      <div class="kpi-sub">ing. clientes ‚Üí compra</div>
    </div>
    <div class="kpi red">
      <div class="kpi-label">Tiendas Bajo Meta</div>
      <div class="kpi-value">19 / 28</div>
      <div class="kpi-sub">68% de la red</div>
    </div>
    <div class="kpi green">
      <div class="kpi-label">Var Vta vs 2025</div>
      <div class="kpi-value">+7.2%</div>
      <div class="kpi-sub">Crecimiento en ventas</div>
    </div>
    <div class="kpi cyan">
      <div class="kpi-label">Var Unds vs 2025</div>
      <div class="kpi-value">+2.9%</div>
      <div class="kpi-sub">90,909 unidades</div>
    </div>
    <div class="kpi yellow">
      <div class="kpi-label">Var Clientes vs 2025</div>
      <div class="kpi-value">-0.4%</div>
      <div class="kpi-sub">41,510 clientes</div>
    </div>
  </div>

  <!-- ALERTS -->
  <div class="section-title"><span class="icon">‚ö†Ô∏è</span> Se√±ales Cr√≠ticas</div>
  <div class="alerts">
    <div class="alert alert-red">
      <div class="alert-icon">üî¥</div>
      <div>
        <div class="alert-title">T36 con cumplimiento cr√≠tico ‚Äî 74.3%</div>
        <div class="alert-body">La tienda T36 est√° 26 puntos por debajo del presupuesto de corte. Aunque mantiene alta rentabilidad (53.7%), presenta efectividad muy baja (23.6%) y requiere an√°lisis urgente de causas ra√≠z.</div>
        <div class="alert-stores"><span class="store-tag">T36</span></div>
      </div>
    </div>
    <div class="alert alert-red">
      <div class="alert-icon">üî¥</div>
      <div>
        <div class="alert-title">P√©rdida de utilidad en 3 tiendas</div>
        <div class="alert-body">T31, T26 y T10 presentan variaci√≥n negativa de utilidad 2026 vs 2025. T31 es la m√°s grave: ‚àí7.0%, y tambi√©n presenta la menor rentabilidad de toda la red (38.8%).</div>
        <div class="alert-stores"><span class="store-tag">T31 ‚àí7.0%</span><span class="store-tag">T26 ‚àí3.9%</span><span class="store-tag">T10 ‚àí2.0%</span></div>
      </div>
    </div>
    <div class="alert alert-yellow">
      <div class="alert-icon">üü°</div>
      <div>
        <div class="alert-title">16 tiendas perdiendo clientes compradores</div>
        <div class="alert-body">El 68% de la red registra ca√≠da en clientes vs 2025. T30 lidera la p√©rdida (‚àí13.0%), seguida de T23 (‚àí10.2%) y T05 (‚àí9.8%). Crisis de retenci√≥n generalizada en TDM.</div>
        <div class="alert-stores"><span class="store-tag">T30</span><span class="store-tag">T23</span><span class="store-tag">T05</span><span class="store-tag">T01</span><span class="store-tag">T10</span></div>
      </div>
    </div>
    <div class="alert alert-yellow">
      <div class="alert-icon">üü°</div>
      <div>
        <div class="alert-title">T10: Peor efectividad de toda la red (15.2%)</div>
        <div class="alert-body">Solo 15.2% de clientes que ingresan compran en T10. Con 63,767 unidades en inventario (2¬∫ mayor de la red), muestra desconexi√≥n severa entre tr√°fico y conversi√≥n. Stock alto sin rotaci√≥n eficiente.</div>
        <div class="alert-stores"><span class="store-tag">T10</span><span class="store-tag">T24 20.1%</span></div>
      </div>
    </div>
    <div class="alert alert-green">
      <div class="alert-icon">üü¢</div>
      <div>
        <div class="alert-title">T29, T27 y T20 lideran con crecimientos excepcionales</div>
        <div class="alert-body">T29 lidera cumplimiento con 121.7% y +48.3% var utilidad. T27 alcanza 118.1% con impresionante +63.6% var utilidad. T20 completa el top 3 con 115.0% y +36.6% var utilidad.</div>
        <div class="alert-stores"><span class="store-tag">T29 +48%</span><span class="store-tag">T27 +64%</span><span class="store-tag">T20 +37%</span></div>
      </div>
    </div>
    <div class="alert alert-green">
      <div class="alert-icon">üü¢</div>
      <div>
        <div class="alert-title">Rentabilidad 2026 supera significativamente a 2025</div>
        <div class="alert-body">La rentabilidad total se mantiene en 51.1% en 2026 vs 40.9% en 2025, un incremento sostenido de +10.2 puntos porcentuales. T24, T32 y T36 lideran con rentabilidades superiores al 53.7%.</div>
      </div>
    </div>
  </div>

  <!-- Mini charts -->
  <div class="two-col mt-20">
    <div class="chart-card">
      <div class="chart-title">Distribuci√≥n de Cumplimiento</div>
      <div class="hbar" id="hbar-cump"></div>
    </div>
    <div class="chart-card">
      <div class="chart-title">Variaci√≥n Utilidad 2026 vs 2025</div>
      <div class="hbar" id="hbar-util"></div>
    </div>
  </div>

</div>

<!-- TAB: CUMPLIMIENTO -->
<div id="tab-cumplimiento" class="tab-panel">
  <div class="filter-bar">
    <input type="text" id="cump-search" placeholder="üîç Buscar tienda..." oninput="renderCumpTable()">
    <select id="cump-filter" onchange="renderCumpTable()">
      <option value="all">Todas</option>
      <option value="over">Sobre meta ‚â•100%</option>
      <option value="under">Bajo meta <100%</option>
    </select>
    <button class="filter-btn secondary" onclick="document.getElementById('cump-search').value=''; renderCumpTable()">‚úï Limpiar</button>
  </div>
  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th onclick="sortCump('tienda')">Tienda ‚Üï</th>
          <th onclick="sortCump('ejecutado')">Ejecutado ($) ‚Üï</th>
          <th onclick="sortCump('pptoCorte')">Ppto Corte ($) ‚Üï</th>
          <th onclick="sortCump('cump')">Cumplimiento ‚Üï</th>
          <th onclick="sortCump('diferencia')">Diferencia ($) ‚Üï</th>
          <th>Visual</th>
          <th onclick="sortCump('varUtil')">Var Utilidad ‚Üï</th>
          <th onclick="sortCump('varUnds')">Var Unds ‚Üï</th>
        </tr>
      </thead>
      <tbody id="cump-tbody"></tbody>
    </table>
  </div>
</div>

<!-- TAB: RENTABILIDAD -->
<div id="tab-rentabilidad" class="tab-panel">
  <div class="kpi-grid" style="grid-template-columns:repeat(4,1fr)">
    <div class="kpi green">
      <div class="kpi-label">Rent. Total 2026</div>
      <div class="kpi-value">51.1%</div>
      <div class="kpi-badge badge-up">‚ñ≤ +10.2pp vs 2025</div>
    </div>
    <div class="kpi cyan">
      <div class="kpi-label">Mayor Rent. 2026</div>
      <div class="kpi-value">53.8%</div>
      <div class="kpi-sub">T24</div>
    </div>
    <div class="kpi red">
      <div class="kpi-label">Menor Rent. 2026</div>
      <div class="kpi-value">38.8%</div>
      <div class="kpi-sub">T31</div>
    </div>
    <div class="kpi yellow">
      <div class="kpi-label">Mejor Var. Utilidad</div>
      <div class="kpi-value">+69.6%</div>
      <div class="kpi-sub">T27</div>
    </div>
  </div>

  <div class="two-col">
    <div>
      <div class="section-title"><span class="icon">üí∞</span> Rentabilidad 2026 por Tienda</div>
      <div class="chart-card">
        <div class="hbar" id="hbar-rent"></div>
      </div>
    </div>
    <div>
      <div class="section-title"><span class="icon">üìä</span> Detalle Rentabilidad</div>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th onclick="sortRent('tienda')">Tienda ‚Üï</th>
              <th onclick="sortRent('rent2026')">Rent 2026 ‚Üï</th>
              <th onclick="sortRent('rent2025')">Rent 2025 ‚Üï</th>
              <th onclick="sortRent('varRent')">Var (pp) ‚Üï</th>
              <th onclick="sortRent('varUtil')">Var Utilidad ‚Üï</th>
            </tr>
          </thead>
          <tbody id="rent-tbody"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- TAB: CLIENTES -->
<div id="tab-clientes" class="tab-panel">
  <div class="kpi-grid" style="grid-template-columns:repeat(4,1fr)">
    <div class="kpi cyan">
      <div class="kpi-label">Efectividad Prom</div>
      <div class="kpi-value">53.7%</div>
      <div class="kpi-sub">Clientes que compran / ingresan</div>
    </div>
    <div class="kpi green">
      <div class="kpi-label">Ganando Clientes</div>
      <div class="kpi-value">11</div>
    </div>
    <div class="kpi red">
      <div class="kpi-label">Perdiendo Clientes</div>
      <div class="kpi-value">16</div>
    </div>
    <div class="kpi yellow">
      <div class="kpi-label">Mejor Ticket Promedio</div>
      <div class="kpi-value">$96,552</div>
      <div class="kpi-sub">T02 (2026)</div>
    </div>
  </div>

  <div class="two-col">
    <div>
      <div class="section-title"><span class="icon">üë•</span> Efectividad por Tienda</div>
      <div class="chart-card">
        <div class="hbar" id="hbar-efect"></div>
      </div>
    </div>
    <div>
      <div class="section-title"><span class="icon">üìà</span> Variaci√≥n Clientes 2026 vs 2025</div>
      <div class="chart-card">
        <div class="hbar" id="hbar-clientes"></div>
      </div>
    </div>
  </div>

  <div class="mt-20">
    <div class="section-title"><span class="icon">üìã</span> Detalle Clientes</div>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th onclick="sortClientes('tienda')">Tienda ‚Üï</th>
            <th onclick="sortClientes('efectividad')">Efectividad ‚Üï</th>
            <th onclick="sortClientes('varClientes')">Var Clientes ‚Üï</th>
            <th onclick="sortClientes('promCompra2026')">Prom Compra 2026 ‚Üï</th>
            <th onclick="sortClientes('promCompra2025')">Prom Compra 2025 ‚Üï</th>
          </tr>
        </thead>
        <tbody id="clientes-tbody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- TAB: INVENTARIO -->
<div id="tab-inventario" class="tab-panel">
  <div class="kpi-grid" style="grid-template-columns:repeat(4,1fr)">
    <div class="kpi cyan">
      <div class="kpi-label">Mayor Stock (Unds)</div>
      <div class="kpi-value">65,188</div>
      <div class="kpi-sub">T02</div>
    </div>
    <div class="kpi yellow">
      <div class="kpi-label">Mayor Vta x M¬≤ 2026</div>
      <div class="kpi-value">$251,716</div>
      <div class="kpi-sub">T20</div>
    </div>
    <div class="kpi green">
      <div class="kpi-label">Mayor PxM¬≤ (productividad)</div>
      <div class="kpi-value">68.4</div>
      <div class="kpi-sub">T05 prendas/m¬≤</div>
    </div>
    <div class="kpi red">
      <div class="kpi-label">Menor PxM¬≤</div>
      <div class="kpi-value">34.3</div>
      <div class="kpi-sub">T04</div>
    </div>
  </div>

  <div class="two-col">
    <div>
      <div class="section-title"><span class="icon">üì¶</span> Unidades en Inventario</div>
      <div class="chart-card">
        <div class="hbar" id="hbar-inv"></div>
      </div>
    </div>
    <div>
      <div class="section-title"><span class="icon">üìê</span> Venta por M¬≤</div>
      <div class="chart-card">
        <div class="hbar" id="hbar-vtam2"></div>
      </div>
    </div>
  </div>

  <div class="mt-20">
    <div class="section-title"><span class="icon">üìã</span> Detalle Inventario & Productividad</div>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th onclick="sortInv('tienda')">Tienda ‚Üï</th>
            <th onclick="sortInv('undsInv')">Unds Inventario ‚Üï</th>
            <th onclick="sortInv('unds2026')">Unds Vendidas 2026 ‚Üï</th>
            <th onclick="sortInv('varUnds')">Var Unds ‚Üï</th>
            <th onclick="sortInv('pxm2')">PxM¬≤ ‚Üï</th>
            <th onclick="sortInv('vtaM2')">Vta x M¬≤ 2026 ‚Üï</th>
          </tr>
        </thead>
        <tbody id="inv-tbody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- TAB: RANKING -->
<div id="tab-ranking" class="tab-panel">
  <div class="section-title"><span class="icon">üèÜ</span> Ranking General ‚Äî Todas las M√©tricas</div>
  <div class="filter-bar">
    <select id="rank-sort" onchange="renderRanking()">
      <option value="cump">Ordenar por: Cumplimiento</option>
      <option value="rent2026">Rentabilidad 2026</option>
      <option value="varUtil">Variaci√≥n Utilidad</option>
      <option value="efectividad">Efectividad</option>
      <option value="vtaM2">Venta x M¬≤</option>
      <option value="ejecutado">Ventas Ejecutadas</option>
      <option value="venta2025">Venta 2025 ($)</option>
      <option value="unds2026">Unds 2026</option>
      <option value="clientesCompran2026">Clientes Compran 2026</option>
      <option value="pxm2">PxM¬≤ (Productividad)</option>
      <option value="utilidadM2">Utilidad por M¬≤ 2026</option>
      <option value="promCompra2026">Prom Compra por Cliente 2026</option>
      <option value="undsCliente">Unds por Cliente 2026</option>
      <option value="pvp">PVP</option>
      <option value="pvpInv">PVP Inventario</option>
      <option value="prendasM2">Prendas Vendidas x M¬≤</option>
    </select>
  </div>
  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>Rank</th>
          <th>Tienda</th>
          <th>Ejecutado ($)</th>
          <th>Cump (%)</th>
          <th>Rent 2026</th>
          <th>Var Utilidad</th>
          <th>Efectividad</th>
          <th>Var Clientes</th>
          <th>Vta x M¬≤</th>
          <th>PxM¬≤</th>
          <th>Venta 2025 ($)</th>
          <th>Unds 2026</th>
          <th>Clientes 2026</th>
          <th>Util x M¬≤</th>
          <th>Prom Compra</th>
          <th>PVP</th>
        </tr>
      </thead>
      <tbody id="rank-tbody"></tbody>
    </table>
  </div>
</div>

</main>

<script>
const STORES = [{"tienda": "T01", "ejecutado": 138539141.0, "cump": 0.9896080969579963, "rent2026": 0.5132431444049451, "rent2025": 0.3896881311559964, "varRent": 0.317061268667401, "utilidad": 71104264.35000005, "varUtil": 0.04173064230060741, "efectividad": 0.527337431252022, "varClientes": -0.08938547486033521, "vtaM2": 121739.1397188049, "unds2026": 4016.0, "unds2025": 3938.0, "varUnds": 0.01980700863382423, "promCompra2026": 84993.33803680982, "promCompra2025": 78279.56759776536, "undsInv": 48385.0, "pxm2": 42.51757469244289, "pptoCorte": 139993944.4976876, "diferencia": -1454803.497687608, "venta2025": 140120426.0, "varVta": -0.01128518550179114, "clientesCompran2026": 1630.0, "utilidadM2": 62481.77886643238, "undsCliente": 2.463803680981595, "pvp": 34496.79805776892, "pvpInv": 40931.78473287175, "prendasM2": 3.528998242530756}, {"tienda": "T02", "ejecutado": 221536288.5, "cump": 1.06440191348941, "rent2026": 0.5137423246124305, "rent2025": 0.4181205257288644, "varRent": 0.2286943428976107, "utilidad": 113812567.8400001, "varUtil": 0.07668337731564367, "efectividad": 0.3372058823529412, "varClientes": -0.03695926081478373, "vtaM2": 148482.7670911528, "unds2026": 5894.0, "unds2025": 5655.0, "varUnds": 0.04226348364279398, "promCompra2026": 96614.16855647623, "promCompra2025": 86877.63964720706, "undsInv": 64953.0, "pxm2": 43.53418230563003, "pptoCorte": 208132177.9794077, "diferencia": 13404110.5205923, "venta2025": 206855660.0, "varVta": 0.07097039790934412, "clientesCompran2026": 2293.0, "utilidadM2": 76281.88193029494, "undsCliente": 2.570431748800698, "pvp": 37586.74728537496, "pvpInv": 41078.85334780533, "prendasM2": 3.950402144772118}, {"tienda": "T04", "ejecutado": 101779949.5, "cump": 0.9634772951686501, "rent2026": 0.5126909269099218, "rent2025": 0.3939662536909156, "varRent": 0.3013574693434302, "utilidad": 52181656.65000004, "varUtil": 0.0807122917574905, "efectividad": 0.4765564950038432, "varClientes": -0.02439024390243905, "vtaM2": 90390.71891651866, "unds2026": 2623.0, "unds2025": 2669.0, "varUnds": -0.01723491944548516, "promCompra2026": 82080.60443548387, "promCompra2025": 77415.86939417782, "undsInv": 39538.0, "pxm2": 35.11367673179396, "pptoCorte": 105638140.1101768, "diferencia": -3858190.610176772, "venta2025": 98395570.0, "varVta": 0.03439564911306481, "clientesCompran2026": 1240.0, "utilidadM2": 46342.50146536416, "undsCliente": 2.115322580645161, "pvp": 38802.87819290888, "pvpInv": 37813.38830745104, "prendasM2": 2.329484902309059}, {"tienda": "T05", "ejecutado": 71978327.5, "cump": 1.001479908230423, "rent2026": 0.530472654425042, "rent2025": 0.4303008443925883, "varRent": 0.2327948256152181, "utilidad": 38182534.45, "varUtil": 0.06749922118338181, "efectividad": 0.7381144238517324, "varClientes": -0.09842519685039375, "vtaM2": 263656.8772893773, "unds2026": 2015.0, "unds2025": 1985.0, "varUnds": 0.01511335012594462, "promCompra2026": 78578.96015283842, "promCompra2025": 67539.15846456694, "undsInv": 19206.0, "pxm2": 70.35164835164835, "pptoCorte": 71871963.58954714, "diferencia": 106363.9104528576, "venta2025": 68619785.0, "varVta": 0.04894422942304466, "clientesCompran2026": 916.0, "utilidadM2": 139862.7635531135, "undsCliente": 2.199781659388646, "pvp": 35721.25434243176, "pvpInv": 37843.3259606373, "prendasM2": 7.38095238095238}, {"tienda": "T06", "ejecutado": 163804854.5, "cump": 0.9896144224583561, "rent2026": 0.5233302696776916, "rent2025": 0.4211571350102543, "varRent": 0.2426009823268209, "utilidad": 85724038.68000002, "varUtil": 0.163458030520679, "efectividad": 0.6239561586638831, "varClientes": 0.08583106267029983, "vtaM2": 232018.2075070821, "unds2026": 4517.0, "unds2025": 4081.0, "varUnds": 0.1068365596667484, "promCompra2026": 68508.93120033458, "promCompra2025": 65153.3090417802, "undsInv": 38978.0, "pxm2": 55.20963172804532, "pptoCorte": 165523915.9642432, "diferencia": -1719061.464243204, "venta2025": 143467586.51, "varVta": 0.141755141246364, "clientesCompran2026": 2391.0, "utilidadM2": 121422.1511048159, "undsCliente": 1.889167712254287, "pvp": 36264.0811379234, "pvpInv": 42366.27715377904, "prendasM2": 6.398016997167138}, {"tienda": "T08", "ejecutado": 77276744.0, "cump": 1.10842621906947, "rent2026": 0.5274814673868762, "rent2025": 0.424600299006753, "varRent": 0.2423012150975592, "utilidad": 40762050.31999999, "varUtil": 0.141564370952576, "efectividad": 0.5331870543060888, "varClientes": 0.03846153846153855, "vtaM2": 102082.8850726552, "unds2026": 2126.0, "unds2025": 2044.0, "varUnds": 0.04011741682974557, "promCompra2026": 79502.82304526749, "promCompra2025": 73865.50747863248, "undsInv": 33487.0, "pxm2": 44.23645970937913, "pptoCorte": 69717535.25, "diferencia": 7559208.75, "venta2025": 69138115.0, "varVta": 0.1177155176996074, "clientesCompran2026": 972.0, "utilidadM2": 53846.83001321002, "undsCliente": 2.18724279835391, "pvp": 36348.42144873001, "pvpInv": 36528.93828649924, "prendasM2": 2.808454425363276}, {"tienda": "T09", "ejecutado": 199448401.0, "cump": 1.066481449228173, "rent2026": 0.5066393740604613, "rent2025": 0.4101317171351055, "varRent": 0.2353089334311695, "utilidad": 101048413.0399999, "varUtil": 0.07628993964610986, "efectividad": 0.2573460211230785, "varClientes": -0.01756487025948106, "vtaM2": 173735.5409407665, "unds2026": 5491.0, "unds2025": 5306.0, "varUnds": 0.03486618921975126, "promCompra2026": 81043.6412027631, "promCompra2025": 74319.19181636727, "undsInv": 51262.0, "pxm2": 44.65331010452962, "pptoCorte": 187015349.5349999, "diferencia": 12433051.46500006, "venta2025": 186169575.5, "varVta": 0.07132650683838504, "clientesCompran2026": 2461.0, "utilidadM2": 88021.26571428563, "undsCliente": 2.231206826493295, "pvp": 36322.78291750137, "pvpInv": 41415.60670282079, "prendasM2": 4.783101045296167}, {"tienda": "T10", "ejecutado": 234736754.5, "cump": 0.9803395951710363, "rent2026": 0.494564407253914, "rent2025": 0.4098791297714655, "varRent": 0.2066103671335162, "utilidad": 116092443.85, "varUtil": -0.01952233521202662, "efectividad": 0.152049622437972, "varClientes": -0.0763433813892529, "vtaM2": 157859.2834566241, "unds2026": 6428.0, "unds2025": 6453.0, "varUnds": -0.003874167054083388, "promCompra2026": 83269.51206101454, "promCompra2025": 76961.41525884665, "undsInv": 63767.0, "pxm2": 42.88298587760592, "pptoCorte": 239444326.9008698, "diferencia": -4707572.400869817, "venta2025": 234886239.37, "varVta": -0.0006364139099886978, "clientesCompran2026": 2819.0, "utilidadM2": 78071.58295225288, "undsCliente": 2.280241220290883, "pvp": 36517.85228686994, "pvpInv": 39593.53756645285, "prendasM2": 4.322797579018158}, {"tienda": "T11", "ejecutado": 136760925.99, "cump": 0.9783272139180537, "rent2026": 0.5147168639758053, "rent2025": 0.4012471938735352, "varRent": 0.282792432781557, "utilidad": 70393154.94, "varUtil": 0.09234780910566576, "efectividad": 0.6513307984790875, "varClientes": -0.01777522935779818, "vtaM2": 115118.6245707071, "unds2026": 3767.0, "unds2025": 3787.0, "varUnds": -0.005281225244256671, "promCompra2026": 79837.08464098073, "promCompra2025": 74371.96100917431, "undsInv": 42438.0, "pxm2": 35.72222222222222, "pptoCorte": 139790577.2673879, "diferencia": -3029651.277387887, "venta2025": 129704700.0, "varVta": 0.05440223823808998, "clientesCompran2026": 1713.0, "utilidadM2": 59253.49742424242, "undsCliente": 2.199065966141273, "pvp": 36304.99760817626, "pvpInv": 42797.91362222534, "prendasM2": 3.170875420875421}, {"tienda": "T13", "ejecutado": 103271225.68, "cump": 0.952273169911002, "rent2026": 0.5181222717913616, "rent2025": 0.4118220562762617, "varRent": 0.2581217151802837, "utilidad": 53507122.06, "varUtil": 0.04608263679335445, "efectividad": 0.740379403794038, "varClientes": -0.04207573632538575, "vtaM2": 111524.0018142549, "unds2026": 2928.0, "unds2025": 3059.0, "varUnds": -0.04282445243543642, "promCompra2026": 75601.19010248901, "promCompra2025": 70927.23000701264, "undsInv": 35268.0, "pxm2": 38.08639308855292, "pptoCorte": 108447060.0905952, "diferencia": -5175834.410595194, "venta2025": 101142229.99, "varVta": 0.02104952293626972, "clientesCompran2026": 1366.0, "utilidadM2": 57783.06917926567, "undsCliente": 2.143484626647145, "pvp": 35270.22734972677, "pvpInv": 37707.98844278099, "prendasM2": 3.161987041036717}, {"tienda": "T14", "ejecutado": 155223750.93, "cump": 0.9955710955256598, "rent2026": 0.5168548799350938, "rent2025": 0.3883559724786801, "varRent": 0.3308791844664321, "utilidad": 80228153.15000007, "varUtil": 0.1480991803346388, "efectividad": 0.5290821771611526, "varClientes": 0.02111225540679706, "vtaM2": 131434.1667485182, "unds2026": 4150.0, "unds2025": 4000.0, "varUnds": 0.03750000000000009, "promCompra2026": 78277.23193645991, "promCompra2025": 74038.6728990731, "undsInv": 43982.0, "pxm2": 37.24132091447925, "pptoCorte": 155914280.3840063, "diferencia": -690529.4540062547, "venta2025": 143783102.77, "varVta": 0.07956879452170984, "clientesCompran2026": 1983.0, "utilidadM2": 67932.39047417448, "undsCliente": 2.092788703983863, "pvp": 37403.31347710844, "pvpInv": 40154.36325087535, "prendasM2": 3.513971210838273}, {"tienda": "T16", "ejecutado": 106742928.5, "cump": 0.9269969869834572, "rent2026": 0.5225437406844241, "rent2025": 0.4211135799293265, "varRent": 0.2408617664909314, "utilidad": 55777849.15000002, "varUtil": 0.09925562383111286, "efectividad": 0.30041928721174, "varClientes": 0.01272084805653706, "vtaM2": 137732.8109677419, "unds2026": 2907.0, "unds2025": 2962.0, "varUnds": -0.01856853477380149, "promCompra2026": 74489.13363572925, "promCompra2025": 69829.58656537104, "undsInv": 34833.0, "pxm2": 44.9458064516129, "pptoCorte": 115149164.4512809, "diferencia": -8406235.951280877, "venta2025": 98808864.99000001, "varVta": 0.08029708175276551, "clientesCompran2026": 1433.0, "utilidadM2": 71971.41825806454, "undsCliente": 2.028611304954641, "pvp": 36719.2736498108, "pvpInv": 40208.78919989664, "prendasM2": 3.750967741935484}, {"tienda": "T17", "ejecutado": 156851769.5, "cump": 0.9959724573859297, "rent2026": 0.5278391450343187, "rent2025": 0.4175429306482717, "varRent": 0.2641553868839368, "utilidad": 82792503.91000003, "varUtil": 0.176245504753916, "efectividad": 0.382680412371134, "varClientes": -0.01433882103027084, "vtaM2": 169752.9972943723, "unds2026": 4294.0, "unds2025": 4117.0, "varUnds": 0.04299247024532415, "promCompra2026": 84510.65167025862, "promCompra2025": 73218.46521508231, "undsInv": 38982.0, "pxm2": 42.18831168831169, "pptoCorte": 157486051.2826626, "diferencia": -634281.7826626003, "venta2025": 137870370.0, "varVta": 0.1376756985565499, "clientesCompran2026": 1856.0, "utilidadM2": 89602.27695887448, "undsCliente": 2.313577586206896, "pvp": 36528.12517466232, "pvpInv": 42035.63935662612, "prendasM2": 4.647186147186146}, {"tienda": "T18", "ejecutado": 39238775.7, "cump": 1.050154435589668, "rent2026": 0.5002989547912935, "rent2025": 0.3873277409376693, "varRent": 0.291668274469925, "utilidad": 19631118.47000001, "varUtil": 0.1599931368008891, "efectividad": 0.8468468468468469, "varClientes": -0.01260504201680668, "vtaM2": 98096.93925000001, "unds2026": 1092.0, "unds2025": 1113.0, "varUnds": -0.01886792452830188, "promCompra2026": 83486.75680851065, "promCompra2025": 73285.14705882352, "undsInv": 24869.0, "pxm2": 62.1725, "pptoCorte": 37364766.90494307, "diferencia": 1874008.795056931, "venta2025": 34883730.0, "varVta": 0.1248446109404013, "clientesCompran2026": 470.0, "utilidadM2": 49077.79617500002, "undsCliente": 2.323404255319149, "pvp": 35932.94478021978, "pvpInv": 35965.10371144799, "prendasM2": 2.73}, {"tienda": "T19", "ejecutado": 128943834.0, "cump": 0.9474309977961676, "rent2026": 0.4897025418834688, "rent2025": 0.4252376440053545, "varRent": 0.1515973451242776, "utilidad": 63144123.27000005, "varUtil": 0.02055541162526398, "efectividad": 0.3502824858757062, "varClientes": 0.1242444593687038, "vtaM2": 127540.884272997, "unds2026": 3563.0, "unds2025": 3179.0, "varUnds": 0.120792702107581, "promCompra2026": 77027.37992831541, "promCompra2025": 80373.59973136333, "undsInv": 51137.0, "pxm2": 50.58061325420376, "pptoCorte": 136098390.5951336, "diferencia": -7154556.595133632, "venta2025": 119676290.0, "varVta": 0.07743842995132955, "clientesCompran2026": 1674.0, "utilidadM2": 62457.09522255199, "undsCliente": 2.128434886499403, "pvp": 36189.68116755543, "pvpInv": 37408.89546903415, "prendasM2": 3.524233432245302}, {"tienda": "T20", "ejecutado": 125597360.0, "cump": 1.150024685550693, "rent2026": 0.519961205633622, "rent2025": 0.4018626463000562, "varRent": 0.2938779217747596, "utilidad": 65305754.73000006, "varUtil": 0.3657365515633563, "efectividad": 0.8512057465366855, "varClientes": 0.1402061855670103, "vtaM2": 258963.6288659794, "unds2026": 3525.0, "unds2025": 2967.0, "varUnds": 0.1880687563195147, "promCompra2026": 75706.66666666667, "promCompra2025": 66077.84879725086, "undsInv": 28736.0, "pxm2": 59.24948453608248, "pptoCorte": 109212751.3244269, "diferencia": 16384608.67557313, "venta2025": 96143270.0, "varVta": 0.3063562327347511, "clientesCompran2026": 1659.0, "utilidadM2": 134651.0406804125, "undsCliente": 2.124773960216998, "pvp": 35630.45673758865, "pvpInv": 37750.75014267819, "prendasM2": 7.268041237113402}, {"tienda": "T23", "ejecutado": 123474600.69, "cump": 0.9889180066792078, "rent2026": 0.5216982656354281, "rent2025": 0.4166280104036319, "varRent": 0.2521920096778982, "utilidad": 64416485.03000002, "varUtil": 0.05309453283037202, "efectividad": 0.5312080536912752, "varClientes": -0.1020986954055587, "vtaM2": 154343.2508625, "unds2026": 3453.0, "unds2025": 3607.0, "varUnds": -0.04269476018852236, "promCompra2026": 78000.37946304485, "promCompra2025": 68062.79666477596, "undsInv": 41294.0, "pxm2": 51.6175, "pptoCorte": 124858279.3073294, "diferencia": -1383678.617329434, "venta2025": 119994710.52, "varVta": 0.02900036305700304, "clientesCompran2026": 1583.0, "utilidadM2": 80520.60628750004, "undsCliente": 2.181301326595073, "pvp": 35758.6448566464, "pvpInv": 37982.672634281, "prendasM2": 4.316249999999999}, {"tienda": "T24", "ejecutado": 79559184.80000001, "cump": 0.8799631759956436, "rent2026": 0.5378092202372592, "rent2025": 0.4206532003493639, "varRent": 0.2785097552820091, "utilidad": 42787663.14000001, "varUtil": 0.04745427404792402, "efectividad": 0.200964928558174, "varClientes": -0.05166374781085814, "vtaM2": 198897.962, "unds2026": 2184.0, "unds2025": 2272.0, "varUnds": -0.03873239436619713, "promCompra2026": 73461.8511542013, "promCompra2025": 69707.18476357267, "undsInv": 23660.0, "pxm2": 59.15, "pptoCorte": 90411947.87495731, "diferencia": -10852763.0749573, "venta2025": 79605605.0, "varVta": -0.0005831272810499222, "clientesCompran2026": 1083.0, "utilidadM2": 106969.15785, "undsCliente": 2.016620498614958, "pvp": 36428.19816849817, "pvpInv": 40561.39586221471, "prendasM2": 5.46}, {"tienda": "T26", "ejecutado": 90122861.5, "cump": 0.8742741616371926, "rent2026": 0.5055038682942841, "rent2025": 0.407589224235967, "varRent": 0.2402287357862802, "utilidad": 45557455.11000001, "varUtil": -0.0390402853568883, "efectividad": 0.7386819484240688, "varClientes": -0.06661839246922518, "vtaM2": 163859.7481818182, "unds2026": 2868.0, "unds2025": 2946.0, "varUnds": -0.02647657841140527, "promCompra2026": 69916.8824670287, "promCompra2025": 68361.71976828385, "undsInv": 28262.0, "pxm2": 51.38545454545454, "pptoCorte": 103083066.4504978, "diferencia": -12960204.95049782, "venta2025": 94407535.0, "varVta": -0.04538486784979612, "clientesCompran2026": 1289.0, "utilidadM2": 82831.73656363638, "undsCliente": 2.224980605120248, "pvp": 31423.59187587169, "pvpInv": 39151.35062274433, "prendasM2": 5.214545454545454}, {"tienda": "T27", "ejecutado": 55169677.5, "cump": 1.181078521924862, "rent2026": 0.5256100949656631, "rent2025": 0.389162012506139, "varRent": 0.3506202508842551, "utilidad": 28997739.43000001, "varUtil": 0.6358435258316311, "efectividad": 0.4491858506457047, "varClientes": 0.1544011544011543, "vtaM2": 166675.7628398791, "unds2026": 1647.0, "unds2025": 1217.0, "varUnds": 0.3533278553820871, "promCompra2026": 68962.096875, "promCompra2025": 52558.71572871573, "undsInv": 21536.0, "pxm2": 65.06344410876133, "pptoCorte": 46711269.80625069, "diferencia": 8458407.693749309, "venta2025": 36423190.0, "varVta": 0.5146854929510567, "clientesCompran2026": 800.0, "utilidadM2": 87606.46353474322, "undsCliente": 2.05875, "pvp": 33497.07194899819, "pvpInv": 36603.39094539377, "prendasM2": 4.975830815709968}, {"tienda": "T28", "ejecutado": 95152651.12, "cump": 0.9421535669944086, "rent2026": 0.5199399438446252, "rent2025": 0.4052317275300771, "varRent": 0.2830682015292947, "utilidad": 49473664.08000001, "varUtil": 0.0281223470674945, "efectividad": 0.5772773797338793, "varClientes": -0.05685618729096986, "vtaM2": 125200.8567368421, "unds2026": 2571.0, "unds2025": 2859.0, "varUnds": -0.1007345225603358, "promCompra2026": 84355.18716312057, "promCompra2025": 80439.10534280936, "undsInv": 28782.0, "pxm2": 37.87105263157895, "pptoCorte": 100994842.5112365, "diferencia": -5842191.391236499, "venta2025": 96205169.99, "varVta": -0.01094035663685633, "clientesCompran2026": 1128.0, "utilidadM2": 65096.92642105265, "undsCliente": 2.279255319148936, "pvp": 37009.97709840529, "pvpInv": 39775.20087207283, "prendasM2": 3.382894736842105}, {"tienda": "T29", "ejecutado": 52989470.99, "cump": 1.217376967875971, "rent2026": 0.5346108874222604, "rent2025": 0.4002593900296341, "varRent": 0.3356610756406721, "utilidad": 28328748.11000003, "varUtil": 0.4831294164865405, "efectividad": 0.7533129459734964, "varClientes": 0.08516886930983847, "vtaM2": 136923.6976485788, "unds2026": 1428.0, "unds2025": 1214.0, "varUnds": 0.1762767710049424, "promCompra2026": 71704.29092016238, "promCompra2025": 56547.53303964758, "undsInv": 25946.0, "pxm2": 67.04392764857882, "pptoCorte": 43527578.05370168, "diferencia": 9461892.936298318, "venta2025": 38508870.0, "varVta": 0.376032872166854, "clientesCompran2026": 739.0, "utilidadM2": 73200.899509044, "undsCliente": 1.93234100135318, "pvp": 37107.47268207283, "pvpInv": 35594.67137130965, "prendasM2": 3.689922480620155}, {"tienda": "T30", "ejecutado": 57238951.0, "cump": 0.9313737219246907, "rent2026": 0.5275626876879695, "rent2025": 0.4220193190537926, "varRent": 0.250091320157606, "utilidad": 30197134.82999999, "varUtil": -0.01776439214046177, "efectividad": 0.7190697674418605, "varClientes": -0.1295045045045045, "vtaM2": 110074.9057692308, "unds2026": 1489.0, "unds2025": 1697.0, "varUnds": -0.1225692398350029, "promCompra2026": 74047.8020698577, "promCompra2025": 67317.30501126127, "undsInv": 22812.0, "pxm2": 43.86923076923077, "pptoCorte": 61456480.52182028, "diferencia": -4217529.52182027, "venta2025": 59777766.85, "varVta": -0.04247090488292471, "clientesCompran2026": 773.0, "utilidadM2": 58071.41313461537, "undsCliente": 1.926261319534282, "pvp": 38441.20282068503, "pvpInv": 36051.59854462565, "prendasM2": 2.863461538461538}, {"tienda": "T31", "ejecutado": 145072268.0, "cump": 0.9611890178560941, "rent2026": 0.3876133465425662, "rent2025": 0.3652954584916088, "varRent": 0.06109544351608754, "utilidad": 56231947.29000004, "varUtil": -0.06990991694961679, "efectividad": 0.751131221719457, "varClientes": 0.1690140845070423, "vtaM2": 164294.7542468856, "unds2026": 5077.0, "unds2025": 4149.0, "varUnds": 0.2236683538201976, "promCompra2026": 67225.3327154773, "promCompra2025": 70187.32394366198, "undsInv": 34024.0, "pxm2": 38.53227633069083, "pptoCorte": 150930009.919984, "diferencia": -5857741.919984043, "venta2025": 129565800.0, "varVta": 0.1196802551290541, "clientesCompran2026": 2158.0, "utilidadM2": 63682.83951302382, "undsCliente": 2.352641334569046, "pvp": 28574.40772109514, "pvpInv": 39520.621276158, "prendasM2": 5.749716874292186}, {"tienda": "T32", "ejecutado": 146870300.5, "cump": 1.051473917627551, "rent2026": 0.5363550282924628, "rent2025": 0.4168679880602929, "varRent": 0.2866304049590112, "utilidad": 78774624.18000002, "varUtil": 0.1202921693479773, "efectividad": 0.7359659310878823, "varClientes": 0.01984978540772531, "vtaM2": 225954.3084615385, "unds2026": 4031.0, "unds2025": 3959.0, "varUnds": 0.01818641070977511, "promCompra2026": 77259.49526564966, "promCompra2025": 73972.41416309013, "undsInv": 32399.0, "pxm2": 49.84461538461539, "pptoCorte": 139680402.9446443, "diferencia": 7189897.555355698, "venta2025": 137884580.0, "varVta": 0.06516842202369544, "clientesCompran2026": 1901.0, "utilidadM2": 121191.7295076923, "undsCliente": 2.120462914255655, "pvp": 36435.20230711982, "pvpInv": 38813.66912867681, "prendasM2": 6.201538461538461}, {"tienda": "T33", "ejecutado": 85649108.5, "cump": 0.9991063738167686, "rent2026": 0.5250407113110817, "rent2025": 0.4141917083823528, "varRent": 0.267627286315449, "utilidad": 44969268.85000001, "varUtil": 0.1637405457825494, "efectividad": 0.4152700186219739, "varClientes": 0.03432282003710574, "vtaM2": 156579.7230347349, "unds2026": 2339.0, "unds2025": 2226.0, "varUnds": 0.05076370170709787, "promCompra2026": 76815.34394618834, "promCompra2025": 70602.66604823747, "undsInv": 33956.0, "pxm2": 62.07678244972578, "pptoCorte": 85725715.24371801, "diferencia": -76606.74371801317, "venta2025": 76109674.0, "varVta": 0.1253380023674784, "clientesCompran2026": 1115.0, "utilidadM2": 82210.72915904937, "undsCliente": 2.097757847533632, "pvp": 36617.83176571185, "pvpInv": 37025.23919778537, "prendasM2": 4.276051188299817}, {"tienda": "T35", "ejecutado": 114168209.5, "cump": 0.9534517076906958, "rent2026": 0.5103160559770363, "rent2025": 0.4238915681489654, "varRent": 0.2038834794602455, "utilidad": 58261870.39000002, "varUtil": 0.05256565437181693, "efectividad": 0.6406101048617732, "varClientes": -0.008849557522123908, "vtaM2": 183255.5529695024, "unds2026": 3096.0, "unds2025": 3053.0, "varUnds": 0.0140845070422535, "promCompra2026": 84946.58444940476, "promCompra2025": 79129.52802359882, "undsInv": 30649.0, "pxm2": 49.19582664526484, "pptoCorte": 119741994.8793429, "diferencia": -5573785.379342854, "venta2025": 107299640.0, "varVta": 0.06401297804913408, "clientesCompran2026": 1344.0, "utilidadM2": 93518.25102728735, "undsCliente": 2.303571428571428, "pvp": 36876.03666020672, "pvpInv": 42976.72102841853, "prendasM2": 4.969502407704654}, {"tienda": "T36", "ejecutado": 54043037.5, "cump": 0.7426925054892299, "rent2026": 0.5365998665415506, "rent2025": 0, "varRent": 0, "utilidad": 28999486.71000001, "varUtil": 0, "efectividad": 0.2355439398889252, "varClientes": 0, "vtaM2": 77204.33928571429, "unds2026": 1390.0, "unds2025": 0.0, "varUnds": 0, "promCompra2026": 74955.66920943135, "promCompra2025": 0, "undsInv": 26032.0, "pxm2": 37.18857142857143, "pptoCorte": 72766369.79714844, "diferencia": -18723332.29714844, "venta2025": 0.0, "varVta": 0, "clientesCompran2026": 721.0, "utilidadM2": 41427.83815714288, "undsCliente": 1.927877947295423, "pvp": 38879.88309352518, "pvpInv": 39530.0999846343, "prendasM2": 1.985714285714286}];

const STORES_MAP = {};
STORES.forEach(s => STORES_MAP[s.tienda] = s);

// ---- UTILITIES ----
const fmt = (n, dec=1) => isNaN(n) ? '‚Äî' : (n * 100).toFixed(dec) + '%';
const fmtM = (n) => {
  if (isNaN(n) || n === 0) return '‚Äî';
  if (n >= 1e9) return '$' + (n/1e9).toFixed(2) + 'B';
  if (n >= 1e6) return '$' + (n/1e6).toFixed(1) + 'M';
  return '$' + n.toLocaleString('es-CO', {maximumFractionDigits: 0});
};
const fmtN = (n) => isNaN(n) || n===0 ? '‚Äî' : n.toLocaleString('es-CO', {maximumFractionDigits: 0});
const chip = (v, t='%', threshold=0) => {
  const cls = v > threshold ? 'chip-green' : v < threshold ? 'chip-red' : 'chip-yellow';
  const sign = v > 0 ? '+' : '';
  const val = t === '%' ? sign + (v*100).toFixed(1) + '%' : sign + v.toFixed(1);
  return `<span class="chip ${cls}">${val}</span>`;
};
const chipCump = (v) => {
  const cls = v >= 1 ? 'chip-green' : v >= 0.9 ? 'chip-yellow' : 'chip-red';
  return `<span class="chip ${cls}">${(v*100).toFixed(1)}%</span>`;
};

// ---- TAB SWITCHING ----
function switchTab(id) {
  document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
  document.getElementById('tab-' + id).classList.add('active');
  event.target.classList.add('active');
  renderTab(id);
}

function renderTab(id) {
  if (id === 'resumen') { renderHbarCump(); renderHbarUtil(); }
  if (id === 'cumplimiento') renderCumpTable();
  if (id === 'rentabilidad') { renderHbarRent(); renderRentTable(); }
  if (id === 'clientes') { renderHbarEfect(); renderHbarClientes(); renderClientesTable(); }
  if (id === 'inventario') { renderHbarInv(); renderHbarVtaM2(); renderInvTable(); }
  if (id === 'ranking') renderRanking();
}

// ---- HBAR ----
function makeHbar(containerId, data, colorFn, labelFn, maxVal) {
  const el = document.getElementById(containerId);
  if (!el) return;
  const max = maxVal || Math.max(...data.map(d => Math.abs(d.value)));
  el.innerHTML = data.map(d => {
    const pct = Math.min(Math.abs(d.value) / max * 100, 100);
    const color = colorFn(d.value);
    const label = labelFn(d.value);
    return `<div class="hbar-row">
      <div class="hbar-label">${d.label}</div>
      <div class="hbar-track">
        <div class="hbar-fill" style="width:${pct}%;background:${color}" title="${d.label}: ${label}">${pct > 15 ? label : ''}</div>
      </div>
      <div class="hbar-val" style="color:${color}">${label}</div>
    </div>`;
  }).join('');
}

function renderHbarCump() {
  const data = [...STORES].sort((a,b) => b.cump - a.cump).map(s => ({
    label: s.tienda,
    value: s.cump
  }));
  makeHbar('hbar-cump', data,
    v => v >= 1 ? '#059669' : v >= 0.9 ? '#d97706' : '#dc2626',
    v => (v*100).toFixed(1) + '%',
    1.3
  );
}

function renderHbarUtil() {
  const data = [...STORES].filter(s => s.varUtil !== 0).sort((a,b) => b.varUtil - a.varUtil).map(s => ({
    label: s.tienda,
    value: s.varUtil
  }));
  makeHbar('hbar-util', data,
    v => v >= 0 ? '#059669' : '#dc2626',
    v => (v >= 0 ? '+' : '') + (v*100).toFixed(1) + '%',
    null
  );
}

function renderHbarRent() {
  const data = [...STORES].sort((a,b) => b.rent2026 - a.rent2026).map(s => ({
    label: s.tienda,
    value: s.rent2026
  }));
  makeHbar('hbar-rent', data,
    v => v >= 0.53 ? '#059669' : v >= 0.50 ? '#0891b2' : '#d97706',
    v => (v*100).toFixed(1) + '%',
    0.6
  );
}

function renderHbarEfect() {
  const data = [...STORES].sort((a,b) => b.efectividad - a.efectividad).map(s => ({
    label: s.tienda,
    value: s.efectividad
  }));
  makeHbar('hbar-efect', data,
    v => v >= 0.8 ? '#059669' : v >= 0.5 ? '#0891b2' : '#dc2626',
    v => (v*100).toFixed(1) + '%',
    1
  );
}

function renderHbarClientes() {
  const data = [...STORES].filter(s => s.varClientes !== 0).sort((a,b) => b.varClientes - a.varClientes).map(s => ({
    label: s.tienda,
    value: s.varClientes
  }));
  makeHbar('hbar-clientes', data,
    v => v >= 0 ? '#059669' : '#dc2626',
    v => (v >= 0 ? '+' : '') + (v*100).toFixed(1) + '%',
    null
  );
}

function renderHbarInv() {
  const data = [...STORES].filter(s => s.undsInv > 0).sort((a,b) => b.undsInv - a.undsInv).map(s => ({
    label: s.tienda,
    value: s.undsInv
  }));
  makeHbar('hbar-inv', data,
    v => '#0891b2',
    v => v.toLocaleString('es-CO'),
    null
  );
}

function renderHbarVtaM2() {
  const data = [...STORES].filter(s => s.vtaM2 > 0).sort((a,b) => b.vtaM2 - a.vtaM2).map(s => ({
    label: s.tienda,
    value: s.vtaM2
  }));
  makeHbar('hbar-vtam2', data,
    v => '#06b6d4',
    v => '$' + (v/1000).toFixed(0) + 'K',
    null
  );
}

// ---- SORT STATE ----
let cumpSortKey = 'cump', cumpSortDir = -1;
let rentSortKey = 'rent2026', rentSortDir = -1;
let clientesSortKey = 'efectividad', clientesSortDir = -1;
let invSortKey = 'undsInv', invSortDir = -1;

function sortCump(key) { cumpSortKey = key; cumpSortDir *= -1; renderCumpTable(); }
function sortRent(key) { rentSortKey = key; rentSortDir *= -1; renderRentTable(); }
function sortClientes(key) { clientesSortKey = key; clientesSortDir *= -1; renderClientesTable(); }
function sortInv(key) { invSortKey = key; invSortDir *= -1; renderInvTable(); }

function renderCumpTable() {
  const search = document.getElementById('cump-search').value.toLowerCase();
  const filter = document.getElementById('cump-filter').value;
  let rows = [...STORES];
  if (search) rows = rows.filter(r => r.tienda.toLowerCase().includes(search));
  if (filter === 'over') rows = rows.filter(r => r.cump >= 1);
  if (filter === 'under') rows = rows.filter(r => r.cump < 1);
  rows.sort((a,b) => {
    const av = a[cumpSortKey] || 0, bv = b[cumpSortKey] || 0;
    return cumpSortDir * (typeof av === 'string' ? av.localeCompare(bv) : bv - av);
  });
  document.getElementById('cump-tbody').innerHTML = rows.map(r => {
    const pct = Math.min(r.cump * 100, 130);
    const color = r.cump >= 1 ? '#059669' : r.cump >= 0.9 ? '#d97706' : '#dc2626';
    return `<tr>
      <td>${r.tienda}</td>
      <td>${fmtM(r.ejecutado)}</td>
      <td>${fmtM(r.pptoCorte)}</td>
      <td>${chipCump(r.cump)}</td>
      <td style="color:${r.diferencia>=0?'#059669':'#dc2626'}">${r.diferencia>=0?'+':''}${fmtM(Math.abs(r.diferencia))}</td>
      <td>
        <div class="bar-wrap">
          <div class="bar-track">
            <div class="bar-fill" style="width:${Math.min(pct/130*100,100)}%;background:${color}"></div>
          </div>
        </div>
      </td>
      <td>${chip(r.varUtil)}</td>
      <td>${chip(r.varUnds)}</td>
    </tr>`;
  }).join('');
}

function renderRentTable() {
  let rows = [...STORES].sort((a,b) => {
    const av = a[rentSortKey]||0, bv = b[rentSortKey]||0;
    return rentSortDir * (bv - av);
  });
  document.getElementById('rent-tbody').innerHTML = rows.map(r => `<tr>
    <td>${r.tienda}</td>
    <td>${fmt(r.rent2026)}</td>
    <td>${fmt(r.rent2025)}</td>
    <td>${r.varRent > 0 ? chip(r.varRent) : '<span class="chip chip-red">‚Äî</span>'}</td>
    <td>${r.varUtil !== 0 ? chip(r.varUtil) : '‚Äî'}</td>
  </tr>`).join('');
}

function renderClientesTable() {
  let rows = [...STORES].sort((a,b) => {
    const av = a[clientesSortKey]||0, bv = b[clientesSortKey]||0;
    return clientesSortDir * (bv - av);
  });
  document.getElementById('clientes-tbody').innerHTML = rows.map(r => `<tr>
    <td>${r.tienda}</td>
    <td>${fmt(r.efectividad)}</td>
    <td>${r.varClientes !== 0 ? chip(r.varClientes) : '‚Äî'}</td>
    <td>${r.promCompra2026 > 0 ? fmtM(r.promCompra2026) : '‚Äî'}</td>
    <td>${r.promCompra2025 > 0 ? fmtM(r.promCompra2025) : '‚Äî'}</td>
  </tr>`).join('');
}

function renderInvTable() {
  let rows = [...STORES].sort((a,b) => {
    const av = a[invSortKey]||0, bv = b[invSortKey]||0;
    return invSortDir * (bv - av);
  });
  document.getElementById('inv-tbody').innerHTML = rows.map(r => `<tr>
    <td>${r.tienda}</td>
    <td>${r.undsInv > 0 ? fmtN(r.undsInv) : '‚Äî'}</td>
    <td>${fmtN(r.unds2026)}</td>
    <td>${chip(r.varUnds)}</td>
    <td>${r.pxm2 > 0 ? r.pxm2.toFixed(1) : '‚Äî'}</td>
    <td>${r.vtaM2 > 0 ? fmtM(r.vtaM2) : '‚Äî'}</td>
  </tr>`).join('');
}

function renderRanking() {
  const sortKey = document.getElementById('rank-sort').value;
  let rows = [...STORES].sort((a,b) => (b[sortKey]||0) - (a[sortKey]||0));
  document.getElementById('rank-tbody').innerHTML = rows.map((r, i) => {
    const rank = i + 1;
    const rankStyle = rank === 1 ? 'rank-1' : rank === 2 ? 'rank-2' : rank === 3 ? 'rank-3' : '';
    return `<tr>
      <td><span class="rank-num ${rankStyle}">#${rank}</span></td>
      <td><b>${r.tienda}</b></td>
      <td>${fmtM(r.ejecutado)}</td>
      <td>${chipCump(r.cump)}</td>
      <td>${fmt(r.rent2026)}</td>
      <td>${r.varUtil !== 0 ? chip(r.varUtil) : '‚Äî'}</td>
      <td>${fmt(r.efectividad)}</td>
      <td>${r.varClientes !== 0 ? chip(r.varClientes) : '‚Äî'}</td>
      <td>${r.vtaM2 > 0 ? fmtM(r.vtaM2) : '‚Äî'}</td>
      <td>${r.pxm2 > 0 ? r.pxm2.toFixed(1) : '‚Äî'}</td>
      <td>${r.venta2025 > 0 ? fmtM(r.venta2025) : '‚Äî'}</td>
      <td>${r.unds2026 > 0 ? fmtN(r.unds2026) : '‚Äî'}</td>
      <td>${r.clientesCompran2026 > 0 ? fmtN(r.clientesCompran2026) : '‚Äî'}</td>
      <td>${r.utilidadM2 > 0 ? fmtM(r.utilidadM2) : '‚Äî'}</td>
      <td>${r.promCompra2026 > 0 ? fmtM(r.promCompra2026) : '‚Äî'}</td>
      <td>${r.pvp > 0 ? fmtM(r.pvp) : '‚Äî'}</td>
    </tr>`;
  }).join('');
}

// ---- INIT ----
renderHbarCump();
renderHbarUtil();
</script>
</body>
</html>